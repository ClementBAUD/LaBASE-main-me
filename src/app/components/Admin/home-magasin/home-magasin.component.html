<!-- Page Wrapper -->
<div id="wrapper" *ngIf="InfoUSer.profile=='Magasin'">

  <!-- Sidebar header -->
  <app-header-admin></app-header-admin>
  <!-- End of Sidebar -->

  <!-- Content Wrapper -->
  <div id="content-wrapper" class="d-flex flex-column">

      <!-- Main Content -->
      <div id="container-fluid">

          <!-- Topbar menu -->
          <app-menu-admin></app-menu-admin>
          <!-- End of menu -->
          <div class="row">
              <div class="c-subheader px-3">

                  <ol class="breadcrumb border-0 m-0">
                      <li class="breadcrumb-item">Dashboard</li>
                      <li class="breadcrumb-item active">
                          <a routerLink="/home-magasin" >Accueil</a>
                      </li>
                  </ol>
              </div>
          </div>

          <!-- Begin Page Content -->
          <div class="container-fluid" style="padding-top: 10px;">

              <div class="" *ngIf="InfoUSer.profile=='Magasin'">
                  <div class="alert alert-danger text-center" role="alert" *ngIf="errorMessage">{{errorMessage}}</div>
                  <div class="alert  alert-success text-center" role="alert" *ngIf="succesMessage">{{succesMessage}}</div>
                  <div class="alert  alert-success text-center" role="alert" *ngIf="succesMessageNot">{{succesMessageNot}}</div>
                  <!-- Pending Requests Card Example -->
                  <div class="col mb-4">
                      <div class="card border-left-danger shadow h-100 py-2">
                          <div class="card-body">
                              <div class="row no-gutters align-items-center">
                                  <div class="col mr-2">

                                      <button type="button" class="btn btn-success btn-lg" *ngIf="this.Mag==1" (click)="onSubmit()">En ligne</button>
                                      <button type="button" class="btn btn-danger btn-lg" *ngIf="this.Mag==0" (click)="onSubmit()">Hors ligne</button>
                                  </div>

                              </div>
                          </div>
                      </div>
                  </div>
              </div>


              <!-- Content Row -->
              <div class="row" *ngIf="InfoUSer.profile=='Magasin'">

                  <!-- Earnings (Monthly) Card Example -->
                  <div class="col-xl-3 col-md-6 mb-4">
                      <div class="card border-left-primary shadow h-100 py-2">
                          <div class="card-body">
                              <div class="d-flex justify-content-center" *ngIf="!Loading">
                                  <div class="spinner-border text-danger  m-2 " style="width: 20px; height: 20px;" role="status">
                                      <span class="sr-only">Loading...</span>
                                  </div>
                              </div>
                              <div class="row no-gutters align-items-center" *ngIf="Loading">
                                  <div class="col mr-2">
                                      <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                          Nombre d'étudiants actifs</div>
                                      <div class="h5 mb-0 font-weight-bold text-gray-800" *ngFor="let etudiant of nmbreEtu">{{etudiant.nbEtu}}</div>
                                  </div>
                                  <div class="col-auto">
                                      <i class="fas fa-user-friends fa-2x text-gray-300"></i>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>

                  <!-- Earnings (Monthly) Card Example -->
                  <div class="col-xl-3 col-md-6 mb-4">
                      <div class="card border-left-success shadow h-100 py-2">
                          <div class="card-body">
                              <div class="d-flex justify-content-center" *ngIf="!Loading">
                                  <div class="spinner-border text-danger  m-2 " style="width: 20px; height: 20px;" role="status">
                                      <span class="sr-only">Loading...</span>
                                  </div>
                              </div>
                              <div class="row no-gutters align-items-center" *ngIf="Loading">
                                  <div class="col mr-2">
                                      <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                          Nombre de commandes effectuées ce jour</div>
                                      <div class="h5 mb-0 font-weight-bold text-gray-800" *ngFor="let com of nmbreCom">{{com.nbre}}</div>
                                  </div>
                                  <div class="col-auto">
                                      <i class="fas fa-desktop  fa-2x text-gray-300"></i>

                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>

                  <!-- Earnings (Monthly) Card Example -->
                  <div class="col-xl-3 col-md-6 mb-4">
                      <div class="card border-left-info shadow h-100 py-2">
                          <div class="card-body">
                              <div class="d-flex justify-content-center" *ngIf="!Loading">
                                  <div class="spinner-border text-danger  m-2 " style="width: 20px; height: 20px;" role="status">
                                      <span class="sr-only">Loading...</span>
                                  </div>
                              </div>
                              <div class="row no-gutters align-items-center" *ngIf="Loading">
                                  <div class="col mr-2">
                                      <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Nombre de commandes non récupérées ce jour
                                      </div>
                                      <div class="row no-gutters align-items-center">
                                          <div>
                                              <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800" *ngFor="let comNo of nmbreComNoRecup">{{comNo.nbre}}</div>
                                          </div>

                                      </div>
                                  </div>
                                  <div class="col-auto">

                                      <i class="fas fa-shopping-bag fa-2x text-gray-300"></i>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>

                  <div class="col-xl-3 col-md-6 mb-4">
                      <div class="card border-left-warning shadow h-100 py-2">
                          <div class="card-body">
                              <div class="d-flex justify-content-center" *ngIf="!Loading">
                                  <div class="spinner-border text-danger  m-2 " style="width: 20px; height: 20px;" role="status">
                                      <span class="sr-only">Loading...</span>
                                  </div>
                              </div>
                              <div class="row no-gutters align-items-center" *ngIf="Loading">
                                  <div class="col mr-2">
                                      <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                          Nombre de produits donnés ce jour</div>
                                      <div class="h5 mb-0 font-weight-bold text-gray-800" *ngFor="let noProd of nmbreProduitDay"> {{noProd.nbre}} </div>
                                  </div>
                                  <div class="col-auto">
                                      <i class="fas fa-hand-holding-heart fa-2x text-gray-300"></i>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>

              </div>

              <div class="container-fluid" style="padding-top: 10px; width: 100%;" *ngIf="InfoUSer.profile=='Magasin'">

                  <!-- DataTales Example -->
                  <div class="card">

                      <div class="d-flex justify-content-center" style="margin-bottom: 200px; margin-top: 200px;" *ngIf="!Loading">
                          <div class="spinner-border text-danger  m-5 " style="width: 70px; height: 70px;" role="status">
                              <span class="sr-only">Loading...</span>
                          </div>
                      </div>
                      <div class="card-body" *ngIf="Loading">

                          <h6 class="m-2 font-weight-bold">Liste des commandes du jour</h6>
                          <div class="alert  alert-success text-center" role="alert" *ngIf="succesMessage">{{succesMessage}}</div>

                          <div class="table-responsive">
                              <table class="table table-striped table-bordered" datatable [dtOptions]="dtOptions" style="width:100%">
                                  <thead>
                                      <tr>
                                          <th>#</th>
                                          <th>N° Commande </th>
                                          <th>Nom étudiant</th>
                                          <th>Email étudiant</th>
                                          <th>Tél étudiant</th>
                                          <th>Heure de Récupération</th>
                                          <th>Statut Commande</th>
                                          <th>Action</th>

                                      </tr>
                                  </thead>
                                  <tbody>
                                      <tr *ngFor="let commande of listeCommande | slice: (page-1) *
                    pageSize : page * pageSize; index as i">
                                          <th style="text-align: center;">{{ (page -1) * pageSize + i + 1 }}</th>


                                          <td style="text-align: center;">{{ commande.NumCom }}</td>
                                          <td style="text-align: center;">{{ commande.nom }}</td>
                                          <td style="text-align: center;">{{ commande.email }}</td>
                                          <td style="text-align: center;">{{ commande.tel }}</td>
                                          <td style="text-align: center;">{{ commande.heureRecuperation }}</td>

                                          <td style="text-align: center;" *ngIf="commande.nom_statut =='Récupérée'"> <button type="button" class="btn btn-success" [routerLink]="['/detail-magasin-commande',commande.id+'-'+'D']" title="Modifier le statut de la commande">Récupérée</button> </td>
                                          <td style="text-align: center;" *ngIf="commande.nom_statut =='Validée'"> <button type="button" class="btn btn-info" [routerLink]="['/detail-magasin-commande',commande.id+'-'+'D']" title="Modifier le statut de la commande">{{ commande.nom_statut  }}</button> </td>
                                          <td style="text-align: center;" *ngIf="commande.nom_statut =='Annulée'"> <button class="btn btn-danger" [routerLink]="['/detail-magasin-commande',commande.id+'-'+'D']" title="Modifier le statut de la commande">{{ commande.nom_statut  }}</button> </td>
                                          <td style="text-align: center;" *ngIf="commande.nom_statut =='Non récupérée'"> <button class="btn btn-dark" [routerLink]="['/detail-magasin-commande',commande.id+'-'+'D']" title="Modifier le statut de la commande">Non récupérée</button> </td>
                                          <td style="text-align: center;" *ngIf="commande.nom_statut =='En cours'"> <button class="btn btn-warning" [routerLink]="['/detail-magasin-commande',commande.id+'-'+'D']" title="Modifier le statut de la commande">A préparer</button> </td>

                                          <td style="text-align: center;">
                                              <button type="button" class="btn btn-outline-success" [routerLink]="['/detail-magasin-commande',commande.id+'-'+'D']" title="Modifier le statut de la commande" style=" margin:5px 5px"><i class="fa fa-eye fa-1x"  ></i></button>

                                              <button type="button" class="btn btn-danger" (click)="onSubmitnotif(commande.id_usr)" title="Envoyer une notification"> <i class="fa fa-bell fa-1x"></i></button>

                                          </td>

                                      </tr>
                                  </tbody>
                              </table>


                          </div>
                      </div>


                  </div>

              </div>




              <!-- Content Row -->

              <!-- Begin Page Content -->
              <!-- Content Row -->

              <!-- /.container-fluid -->

          </div>
          <!-- End of Main Content -->

          <!-- Footer
      <app-footer-admin></app-footer-admin>-->

          <!-- End of Footer -->

      </div>
      <!-- End of Content Wrapper -->

  </div>
  <!-- End of Page Wrapper -->

  <!-- Scroll to Top Button-->
  <a class="scroll-to-top rounded" href="#page-top">
      <i class="fas fa-angle-up"></i>
  </a>

  <app-logout-modal></app-logout-modal>
